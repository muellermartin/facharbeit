<!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html><head>
<meta http-equiv="content-type" content="text/html; charset=ISO-8859-1">


	<title>CAAD Embedded hosted by ETH Zürich - Photointerrupter </title>
	<meta http-equiv="Content-Style-Type" content="text/css">
	<!--HTMLHeader--><style type="text/css"><!--
  ul, ol, pre, dl, p { margin-top:0px; margin-bottom:0px; }
  code.escaped { white-space: nowrap; }
  .vspace { margin-top:1.33em; }
  .indent { margin-left:40px; }
  .outdent { margin-left:40px; text-indent:-40px; }
  a.createlinktext { text-decoration:none; border-bottom:1px dotted gray; }
  a.createlink { text-decoration:none; position:relative; top:-0.5em;
    font-weight:bold; font-size:smaller; border-bottom:none; }
  img { border:0px; }
  .editconflict { color:green; 
  font-style:italic; margin-top:1.33em; margin-bottom:1.33em; }

  table.markup { border:2px dotted #ccf; width:90%; }
  td.markup1, td.markup2 { padding-left:10px; padding-right:10px; }
  table.vert td.markup1 { border-bottom:1px solid #ccf; }
  table.horiz td.markup1 { width:23em; border-right:1px solid #ccf; }
  table.markup caption { text-align:left; }
  div.faq p, div.faq pre { margin-left:2em; }
  div.faq p.question { margin:1em 0 0.75em 0; font-weight:bold; }
  div.faqtoc div.faq * { display:none; }
  div.faqtoc div.faq p.question 
    { display:block; font-weight:normal; margin:0.5em 0 0.5em 20px; line-height:normal; }
  div.faqtoc div.faq p.question * { display:inline; }
   
    .frame 
      { border:1px solid #cccccc; padding:4px; background-color:#f9f9f9; }
    .lfloat { float:left; margin-right:0.5em; }
    .rfloat { float:right; margin-left:0.5em; }
a.varlink { text-decoration:none; }

--></style>  <meta name="robots" content="index,follow">

	<link rel="stylesheet" href="Photointerrupter-Dateien/pmwiki.css" type="text/css">
<style type="text/css"><!--
#header {background-color: #134A86;}
a:link, a:visited, #menu ul li .here a, #menu ul li .here a:hover {color: #134A86;}
--></style>
<!--[if lte IE 6]>
<style type="text/css">
img, #logo, #vis, #header, #ethlogo, #caadlogo { behavior: url("http://www.embedded.arch.ethz.ch/pub/skins/simpletab/iepngfix.htc"); }
</style>
<![endif]-->
	
</head><body><div id="page"><div id="suptitle"></div>
<div id="header"><div id="vis"><a id="logo" href="http://www.embedded.arch.ethz.ch/" title="CAAD Embedded hosted by ETH Zürich"></a>
<a id="ethlogo" href="http://www.ethz.ch/"></a><a id="caadlogo" href="http://www.caad.arch.ethz.ch/"></a>
<div id="menu"><ul><li> <a class="wikilink" href="http://www.embedded.arch.ethz.ch/Home/Home">Home</a>
</li><li> <a class="wikilink" href="http://www.embedded.arch.ethz.ch/Projects/Projects">Projects</a>
</li><li> <span class="here">  <a class="wikilink" href="http://www.embedded.arch.ethz.ch/Examples/Examples">Examples</a></span>
</li><li> <a class="wikilink" href="http://www.embedded.arch.ethz.ch/Practice/Practice">Practice</a>
</li><li> <a class="wikilink" href="http://www.embedded.arch.ethz.ch/Download/Download">Download</a>
</li></ul>
</div>
	</div></div>

	<div id="tools">
	    <a rel="nofollow" accesskey="e" href="http://www.embedded.arch.ethz.ch/Examples/Photointerrupter?action=edit"></a>
	    <a rel="nofollow" accesskey="h" href="http://www.embedded.arch.ethz.ch/Examples/Photointerrupter?action=diff"></a>      
	    <a rel="nofollow" accesskey="a" href="http://www.embedded.arch.ethz.ch/Examples/Photointerrupter?action=upload"></a>      
	    <a rel="nofollow" accesskey="c" href="http://www.embedded.arch.ethz.ch/Examples/RecentChanges"></a>      
	    <a rel="nofollow" accesskey="r" href="http://www.embedded.arch.ethz.ch/Site/AllRecentChanges%5D"></a>
	    <a rel="nofollow" accesskey="l" href="http://www.embedded.arch.ethz.ch/Examples/SideBar?action=edit"></a>
			<a rel="nofollow" accesskey="t" href="http://www.embedded.arch.ethz.ch/Site/TopBar?action=edit"></a>
			<a rel="nofollow" accesskey="m" href="http://www.embedded.arch.ethz.ch/Site/TabMenu?action=edit"></a>
			<a rel="nofollow" accesskey="f" href="http://www.embedded.arch.ethz.ch/Site/Footer?action=edit"></a>
	</div>

	<div id="content"><!--PageText-->
<div id="wikitext">
<p class="vspace"><a class="wikilink" href="http://www.embedded.arch.ethz.ch/Examples/Examples">Examples</a> - <a class="wikilink" href="http://www.embedded.arch.ethz.ch/Examples/ExampleModules">ExampleModules</a> - Photointerrupter
</p>
<div class="vspace"></div><h1>Photointerrupter</h1>
<div><img src="Photointerrupter-Dateien/IMG_3208_700px.jpg" alt="" title=""><br><br clear="all"></div>
<p>A photointerrupter is more or less a simple light barrier. Mostly the
 light source is an infrared-LED and the receiver is a photo-transistor.
 Normally you want the status of the light barrier (covered-closed or 
opened) directly mapped to a digital Low or High. But a simple 
photo-transistor can also have states between Low and High.<br>To make sure you do not need to filter those value-range by software, it is advisable to use a receiver that includes a <a target="_blank" class="urllink" href="http://en.wikipedia.org/wiki/Schmitt_trigger" title="" rel="nofollow">Schmitt trigger</a>.
 A Schmitt trigger does not only use a threshold to decide between Low 
and High, it also implements a hysteresis that eliminates noise. The 
important fact is, that a photointerrupter with Schmitt trigger output 
will provide you a proper square-wave signal. For example GP1A53HR will 
have this characteristics <a target="_blank" class="urllink" href="http://www.google.com/#q=photo+interrupter+GP1A53HR+datasheet" title="" rel="nofollow">(search google)</a>.
<br clear="all">
<br clear="all">
</p><h2>wire a photointerrupter</h2>
<p>Most photointerupters will not need much (&lt;20mA) current. Therefor
 they can be powered by the arduino-board. I use the following wiring 
for the <strong>GP1A53HR</strong>:
<br clear="all">
<br clear="all">
</p>
<table border="0" cellpadding="1" cellspacing="1"><tbody><tr><td align="left"><strong>pinNo</strong></td><td><strong>pinDescription</strong></td><td><strong>connect</strong></td></tr>
<tr><td>1</td><td>ir-LED Anode</td><td>via 470 Ohm Resistor to 5V - current limited to ~10mA</td></tr>
<tr><td>2</td><td align="left">ir-LED Cathode</td><td align="left">to Ground / 0V</td></tr>
<tr><td>3</td><td align="left">receiver Vcc</td><td align="left">to 5V</td></tr>
<tr><td>4</td><td>receiver Vo</td><td>to digital input / MicroController</td></tr>
<tr><td>5</td><td align="left">receiver GND</td><td>to Ground / 0V</td></tr>
</tbody></table><p><br clear="all">
<br clear="all">
</p><h2>photointerrupter code snippets</h2>
<table border="0"><tbody><tr><td><img src="Photointerrupter-Dateien/IMG_3221_320px.jpg" alt="" title=""></td><td>A
 common usage for photointerrupters is to query, if a mechanical 
component has reached a specific position, or to count the pulses of an 
encoder wheel.</td></tr>
</tbody></table><p><br clear="all">
<br clear="all">
The linked code examples will show how to count pulses. It is also 
possible to use an external interrupt to stop a motor at an inital or 
final position, or to detect a coin dropping through a slot.
<br clear="all">
<br clear="all">
<strong>How does the code look:</strong> Of course it is possible to 
query the Photointerrupter status continuously within the main loop. 
This approach is not very efficient because you occupy your CPU and you 
might miss a very short timed event ( for example the dropping coin ) - 
but to have a complete list here is an <strong><a target="_blank" class="wikilink" href="http://www.embedded.arch.ethz.ch/Examples/PhotointerrupterCountSimple">Example simple</a></strong>.
<br clear="all">
<br clear="all">
To have some script timed independent from your main loop, you can cause
 a function to be called with signal-changes at some special input Pins.
 This method is called external interrupts and can be accessed via the 
arduino-function <a target="_blank" class="urllink" href="http://www.arduino.cc/en/Reference/AttachInterrupt" title="" rel="nofollow">attachInterrupt</a>.
 This method is nice to react on single events (initial position of a 
motor, the dropping coin or a switch). It still will consume some CPU 
and will interrupt the execution of your main loop.<strong><a target="_blank" class="wikilink" href="http://www.embedded.arch.ethz.ch/Examples/PhotointerrupterCountInterrupt">Example interrupt</a></strong>
<br clear="all">
<br clear="all">
If you just want to <strong>count</strong> events, like the number of 
stripes of an encoder wheel that passed by, you can use one of Arduinos 
Timers/Counters and set them to use an external clock. Be aware of using
 Timer0 which is used for some functions like delay() and millis().You 
also have to take account, that each Timer is used to control two 
PWM-Pins, using a Timer for something else will decrease the number of 
PWM-Pins. You will find more information about timers in <strong><a target="_blank" class="wikilink" href="http://www.embedded.arch.ethz.ch/Examples/TimerDcMotorBackground">this article</a></strong>. Timer1 is a 16-Bit Timer - it can count from 0 to 65535. There are also 8-Bit Timers that only count from 0 to 255. This <strong><a target="_blank" class="wikilink" href="http://www.embedded.arch.ethz.ch/Examples/PhotointerrupterCountTimer1">Example Timer1</a></strong> shows, how to count pulses with Timer1 on a ATM168.
<br clear="all">
<br clear="all">
</p><h2>Example Project</h2>
<p>In the <a target="_blank" class="urllink" href="http://www.embedded.arch.ethz.ch/Projects/EmbossingPrinter" title="" rel="nofollow">Embossing Printer</a> Project i made intensive use of photointerrupters.
<br clear="all">
<br clear="all">
</p><hr>
<p>Article by 
<a target="_blank" class="urllink" href="http://wiki.caad.arch.ethz.ch/Organisation/TomPawlofsky" title="" rel="nofollow">Tom Pawlofsky</a> Mai 2010
<br clear="all">
<br clear="all">
contact<br>pawlofsky&#8211;AT-arch-DOT-ethz-DOT-ch<br>please feel free to email any comments, misstakes or improvements.
<br clear="all">
<br clear="all">
</p><hr>
<p>this page is linked to:<br clear="all">
</p><div class="fpltemplate"><div class="vspace"></div><dl><dt><a class="wikilink" href="http://www.embedded.arch.ethz.ch/Examples/Examples">Examples</a> /</dt><dd>
</dd><dt> </dt><dd><a class="wikilink" href="http://www.embedded.arch.ethz.ch/Examples/PhotointerrupterCountInterrupt">PhotointerrupterCountInterrupt</a>
</dd><dt> </dt><dd><a class="wikilink" href="http://www.embedded.arch.ethz.ch/Examples/PhotointerrupterCountSimple">PhotointerrupterCountSimple</a>
</dd><dt> </dt><dd><a class="wikilink" href="http://www.embedded.arch.ethz.ch/Examples/PhotointerrupterCountTimer1">PhotointerrupterCountTimer1</a>
</dd><dt> </dt><dd><a class="wikilink" href="http://www.embedded.arch.ethz.ch/Examples/TimerDcMotorBackground">TimerDcMotorBackground</a>
<div class="vspace"></div></dd><dt><a class="wikilink" href="http://www.embedded.arch.ethz.ch/Projects/Projects">Projects</a> /</dt><dd>
</dd><dt> </dt><dd><a class="wikilink" href="http://www.embedded.arch.ethz.ch/Projects/EmbossingPrinter">EmbossingPrinter</a>
</dd></dl>
</div>
</div>
</div>
	
	<div class="clear"> </div>
	<div id="footer">
		<p>You are not logged in. <a class="urllink" href="http://www.embedded.arch.ethz.ch/Examples/Photointerrupter?action=login" title="" rel="nofollow">login</a>
</p>

		<!--HTMLFooter-->
	</div>
</div>


</body></html>